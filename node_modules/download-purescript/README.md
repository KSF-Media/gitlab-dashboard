# download-purescript

[![npm version](https://img.shields.io/npm/v/download-purescript.svg)](https://www.npmjs.com/package/download-purescript)
[![Build Status](https://travis-ci.org/shinnn/download-purescript.svg?branch=master)](https://travis-ci.org/shinnn/download-purescript)
[![Build status](https://ci.appveyor.com/api/projects/status/54yy5dm8octs4hp8/branch/master?svg=true)](https://ci.appveyor.com/project/ShinnosukeWatanabe/download-purescript/branch/master)
[![Coverage Status](https://img.shields.io/coveralls/shinnn/download-purescript.svg)](https://coveralls.io/github/shinnn/download-purescript?branch=master)

A [Node.js](https://nodejs.org) module to download a prebuilt [PureScript](http://www.purescript.org/) binary

```javascript
const {readdirSync} = require('fs');
const downloadPurescript = require('download-purescript');

downloadPurescript('./dest/').subscribe({
  complete() {
    readdirSync('./dest/'); //=> ['purs']
  }
});
```

## Installation

[Use](https://docs.npmjs.com/cli/install) [npm](https://docs.npmjs.com/getting-started/what-is-npm).

```
npm install download-purescript
```

## API

```javascript
const downloadPurescript = require('download-purescript');
```

### downloadPurescript(*dir* [, *options*])

*dir*: `string` (a directory path where the `purs` binary will be downloaded)  
*options*: `Object`  
Return: [`Observable`](https://github.com/tc39/proposal-observable#observable) ([zenparsing's implementation](https://github.com/zenparsing/zen-observable))

When the `Observable` is [subscribe](https://tc39.github.io/proposal-observable/#observable-prototype-subscribe)d, it starts to download a `tar.gz` archive from the [PureScript release page](https://github.com/purescript/purescript/releases), extract it and successively send [dl-tar](https://github.com/shinnn/dl-tar)'s [`progress` objects](https://github.com/shinnn/dl-tar#progress) to its [`Observer`](https://github.com/tc39/proposal-observable#observer).

## Options

You can pass options to [Request](https://github.com/request/request#requestoptions-callback) and [tar-fs](https://github.com/mafintosh/tar-fs)'s [`extract` method](https://github.com/mafintosh/tar-fs/blob/12968d9f650b07b418d348897cd922e2b27ec18c/index.js#L167). Note that:

* [`strip` option](https://github.com/mafintosh/tar-fs/blob/b79d82a79c5e21f6187462d7daaba1fc03cdd1de/index.js#L48) defaults to `1` and can't be changed.
* All files except for `purs` and `purs.exe`, for example `README`, won't be downloaded by default. Pass `() => false` to [`ignore` option](https://github.com/mafintosh/tar-fs/blob/835bd4809d7a34a3924bcfc52df5f0a02d5aea9c/index.js#L173) if you want to download all files included in the archive.
* `followRedirect` option defaults to `true` and cannot be disabled.
* [`fs`](https://github.com/mafintosh/tar-fs/blob/e59deed830fded0e4e5beb016d2df9c7054bb544/index.js#L65) option defaults to [graceful-fs](https://github.com/isaacs/node-graceful-fs) for more stability.

Additionally, you can use the following:

### version

Type: `string`  
Default: [`0.12.0-rc1`](https://github.com/purescript/purescript/releases/tag/v0.12.0-rc1)

Specify the version you want to download.

```javascript
const {execFileSync} = require('child_process');

downloadPurescript('dir1').subscribe({
  complete() {
    execFileSync('./dir1/purs', ['--version'], {encoding: 'utf8'}).trim(); //=> '0.12.0'
  }
});

downloadPurescript('dir2', {version: '0.11.7'}).subscribe({
  complete() {
    execFileSync('./dir2/purs', ['--version'], {encoding: 'utf8'}).trim(); //=> '0.11.7'
  }
});
```

### platform

Type: `string` (currently supported: `darwin` `linux` `win32`)  
Default: [`process.platform`](https://nodejs.org/api/process.html#process_process_platform)

By default this module tries to download the binary for the current platform. Use this option to download the one for the different platform.

## License

[ISC License](./LICENSE) Â© 2017 - 2018 Shinnosuke Watanabe
